<style>
  .fade-in {
    animation: fadeIn 0.5s ease-out;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>

<div class="min-h-full">
  <!-- Main Content -->
  <main class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-8 fade-in">
      <div class="flex items-center space-x-2 text-sm text-gray-500 mb-4 justify-center">
        <%= link_to resumes_path, class: "hover:text-gray-700" do %>
          My Resumes
        <% end %>
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
        </svg>
        <%= link_to resume_path(@resume), class: "hover:text-gray-700" do %>
          <%= @resume.target_role %>
        <% end %>
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
        </svg>
        <span>Edit Cover Letter</span>
      </div>
      
      <h1 class="text-3xl font-bold text-gray-900">Edit Cover Letter</h1>
      <p class="mt-2 text-lg text-gray-600">
        Update your cover letter for <%= @cover_letter.company_name %>
      </p>
    </div>

    <%= form_with model: [@resume, @cover_letter], local: true, 
        html: { 
          class: "space-y-8"
        } do |f| %>
      
      <!-- Display errors -->
      <% if @cover_letter.errors.any? %>
        <div class="bg-red-50 border border-red-200 rounded-lg p-4 fade-in">
          <div class="flex">
            <svg class="w-5 h-5 text-red-400 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
            </svg>
            <div class="ml-3">
              <h3 class="text-sm font-medium text-red-800">Please fix the following errors:</h3>
              <ul class="mt-2 text-sm text-red-700 list-disc list-inside">
                <% @cover_letter.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      <% end %>

      <!-- Job & Company Information -->
      <div class="bg-white rounded-xl shadow-lg p-8 fade-in" style="animation-delay: 0.1s;">
        <h3 class="text-lg font-semibold text-gray-900 mb-6">Job & Company Details</h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Company Name -->
          <div>
            <%= f.label :company_name, "Company Name", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= f.text_field :company_name, 
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",
                placeholder: "e.g., Google, Microsoft, Apple" %>
          </div>

          <!-- Target Role -->
          <div>
            <%= f.label :target_role, "Job Title", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= f.text_field :target_role, 
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",
                placeholder: "e.g., Senior Software Engineer" %>
          </div>

          <!-- Hiring Manager -->
          <div class="md:col-span-2">
            <%= f.label :hiring_manager_name, "Hiring Manager Name (Optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= f.text_field :hiring_manager_name, 
                class: "w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",
                placeholder: "e.g., Sarah Johnson, John Smith" %>
          </div>
        </div>
      </div>

      <!-- Cover Letter Style -->
      <div class="bg-white rounded-xl shadow-lg p-8 fade-in" style="animation-delay: 0.2s;">
        <h3 class="text-lg font-semibold text-gray-900 mb-6">Cover Letter Style</h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Tone -->
          <div>
            <%= f.label :tone, "Tone", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= f.select :tone,
                options_for_select([
                  ['Professional & Formal', 'professional'],
                  ['Friendly & Approachable', 'friendly'],
                  ['Confident & Assertive', 'confident'],
                  ['Casual & Conversational', 'casual'],
                  ['Enthusiastic & Energetic', 'enthusiastic']
                ], @cover_letter.tone),
                {},
                { class: "w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" } %>
          </div>

          <!-- Length -->
          <div>
            <%= f.label :length, "Length", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= f.select :length,
                options_for_select([
                  ['Short (200-250 words)', 'short'],
                  ['Medium (300-400 words)', 'medium'],
                  ['Long (450-600 words)', 'long']
                ], @cover_letter.length),
                {},
                { class: "w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" } %>
          </div>
        </div>
      </div>

      <!-- Cover Letter Content -->
      <div class="bg-white rounded-xl shadow-lg p-8 fade-in" style="animation-delay: 0.3s;">
        <h3 class="text-lg font-semibold text-gray-900 mb-6">Cover Letter Content</h3>
        <p class="text-sm text-gray-600 mb-4">
          Edit your cover letter content below. You can make any changes you'd like to personalize it further.
        </p>
        
        <%= f.text_area :content,
            rows: 15,
            class: "w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all font-mono text-sm",
            placeholder: "Your cover letter content..." %>
        
        <div class="mt-2 flex items-center justify-between text-xs text-gray-500">
          <span>Word count: <%= @cover_letter.word_count %> words</span>
          <span>Estimated read time: <%= @cover_letter.estimated_read_time %></span>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex items-center justify-between fade-in" style="animation-delay: 0.4s;">
        <div class="flex items-center space-x-4">
          <%= link_to [@resume, @cover_letter], class: "text-gray-600 hover:text-gray-900 font-medium" do %>
            ‚Üê Cancel
          <% end %>
          
          <%= link_to @resume, data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this cover letter?" },
              class: "text-red-600 hover:text-red-800 font-medium" do %>
            Delete
          <% end %>
        </div>
        
        <div class="flex items-center space-x-4">
          <%= link_to preview_resume_cover_letter_path(@resume, @cover_letter), target: "_blank",
              class: "inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50" do %>
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
            </svg>
            Preview
          <% end %>
          
          <%= f.submit "Save Changes", 
              class: "px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-lg shadow-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transform hover:scale-105 transition-all duration-200",
              data: { disable_with: "Saving..." } %>
        </div>
      </div>
    <% end %>
  </main>
</div>
